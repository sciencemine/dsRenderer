{{!-- ce player should only care about the order things are playled not how they are played --}}
{{#if isTeaser}}
    {{asset-middleware asset=currentItem}}
{{else}}
    {{#with (get currentItem 0) as |primaryAsset|}}
        {{!-- note that we only care if the primary asset id done --}}
        {{!-- Only care about options and callbacks on the primary asset --}}
        {{#asset-middleware
            asset=primaryAsset
            onassetdone=(action 'primaryAssetDone' primaryAsset)
            options=options
            callbacks=(hash
                onpause=(action onpause primaryAsset)
                onselect=(action onselect primaryAsset)
                onplay=(action onplay primaryAsset)
            )
        }}
            {{!-- if the concurrent asset is a track put it inside --}}
            {{#each (get currentItem 1) as |asset key|}}
                {{#if (is-track asset.type)}}
                    {{asset-middleware asset=asset
                        onassetdone=(action 'onassetdone' asset)
                    }}
                {{/if}}
            {{/each}}
        {{/asset-middleware}}

        {{!-- otherwise put it outside --}}
        {{#each (get currentItem 1) as |asset key|}}
            {{#unless (is-track asset.type)}}
                {{asset-middleware asset=asset options=(hash
                    playing=options.playing onassetdone=(action 'onassetdone' asset)
                )}}
            {{/unless}}
        {{/each}}
    {{/with}}
{{/if}}